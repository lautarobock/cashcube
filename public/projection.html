
<!DOCTYPE html>
<html ng-app="cashcube">
<head>
    <title>CubeCash - Resume</title>
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
    <script src="./js/common.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.1.5/angular.min.js"></script>
    <script src="./js/angular-resource.js"></script>
    <script src="./js/ui-bootstrap-tpls-0.4.0.min.js"></script>

    <script>
        var cashcube = angular.module('cashcube',['ngResource']);
        cashcube.controller("ProjectionController", function($scope,Movement,Account) {

            $scope.movements = Movement.query();

            $scope.accounts = Account.query();

            $scope.weekMovements = [
                {
                    from:1,
                    to: 7,
                    values: {
                        cash: 1,
                        debito_rio: 2
                    },
                    from:8,
                    to: 14,
                    values: {
                        cash: 1,
                        debito_rio: 2
                    },
                    from:15,
                    to: 21,
                    values: {
                        cash: 1,
                        debito_rio: 2
                    },
                    from:22,
                    to: 28,
                    values: {
                        cash: 1,
                        debito_rio: 2
                    },
                    from:29,
                    to: 31,
                    values: {
                        cash: 1,
                        debito_rio: 2
                    }
                }
            ];

            $scope.navigateTo = function(href) {
                window.location.href = href;
            };

        });
	
	cashcube.factory('Movement',function($resource) {
        var today = new Date();
        var year = today.getYear()+1900;
        var month = today.getMonth()+1;
		return $resource('cube?year='+year+'&month=' + month,{}, {
			query: { method: 'GET', params: {  },isArray:false  }
		});
	});
    cashcube.factory('Account',function($resource) {
        return $resource('account',{},{
            query: { method: 'GET', params: {}, isArray:true  }
        });
    });
    </script>
</head>
<body ng-controller="ProjectionController">
    <button class="btn" ng-click="navigateTo('movement.html')">Movimientos</button>
    <button class="btn" ng-click="navigateTo('account.html')">Cuentas</button>
    <button class="btn" ng-click="navigateTo('currency.html')">Moneda</button>
    <button class="btn" ng-click="navigateTo('category.html')">Categorias</button>
    <button class="btn" ng-click="navigateTo('resume.html')">Resume</button>
    <button class="btn" ng-click="navigateTo('graph.html')">Graficos</button>
    <button class="btn btn-info" ng-click="navigateTo('projection.html')">Cubo</button>
    <div id="example" class="k-content" >
        <div>
            <table border=1>
                <tr>
                    <th>
                       Dia
                    </th>
                    <th ng-repeat="account in accounts">
                        {{account.name}}
                    </th>
                </tr>
                <tr ng-repeat="(day,values) in movements">
                    <td>
                        <strong>{{day}}</strong>
                    </td>
                    <td ng-repeat="account in accounts">
                        {{movements[day][account._id].toFixed(2)}}
                    </td>
                </tr>
            </table>
        </div>
    </div>

</body>
</html>
